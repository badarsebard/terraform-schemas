{"format_version":"0.2","provider_schemas":{"registry.terraform.io/satoricyber/satori":{"provider":{"version":0,"block":{"attributes":{"satori_account":{"type":"string","description":"Your Satori account ID.","description_kind":"markdown","required":true},"service_account":{"type":"string","description":"Service account ID with administrative privileges. Can be specified with the `SATORI_SA` environment variable.","description_kind":"markdown","optional":true},"service_account_key":{"type":"string","description":"Service account key. Can be specified with the `SATORI_SA_KEY` environment variable.","description_kind":"markdown","optional":true,"sensitive":true},"url":{"type":"string","description":"Defaults to `https://app.satoricyber.com`.","description_kind":"markdown","optional":true},"verify_tls":{"type":"bool","description":"Defaults to `true`.","description_kind":"markdown","optional":true}},"description_kind":"plain"}},"resource_schemas":{"satori_access_rule":{"version":0,"block":{"attributes":{"access_level":{"type":"string","description":"Access level to grant, valid values are: READ_ONLY, READ_WRITE, OWNER.","description_kind":"markdown","required":true},"enabled":{"type":"bool","description":"Enable the rule. Defaults to `true`.","description_kind":"markdown","optional":true},"expire_on":{"type":"string","description":"Expire the rule on the given date and time. RFC3339 date format is expected. Time must be in UTC (i.e. YYYY-MM-DD***T***HH:MM:SS***Z***). Empty value = never expire.","description_kind":"markdown","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"parent_data_policy":{"type":"string","description":"Parent data policy ID, the data_policy_id field of a dataset.","description_kind":"markdown","required":true},"revoke_if_not_used_in_days":{"type":"number","description":"Revoke access if rule not used in the last given days. Zero = do not revoke. Max value is 180. Defaults to `0`.","description_kind":"markdown","optional":true},"security_policies":{"type":["list","string"],"description":"IDs of security policies to apply to this rule. Empty list for default dataset security policies. [ \"none\" ] list for no policies.","description_kind":"markdown","optional":true}},"block_types":{"identity":{"nesting_mode":"list","block":{"attributes":{"group_id":{"type":"string","description":"Directory group ID for identity of type GROUP.\nCan not be changed after creation.","description_kind":"markdown","optional":true},"name":{"type":"string","description":"User/group name for identity types of USER and IDP_GROUP.\nCan not be changed after creation.","description_kind":"markdown","optional":true},"type":{"type":"string","description":"Identity type, valid types are: USER, IDP_GROUP, GROUP, EVERYONE.\nCan not be changed after creation.","description_kind":"markdown","required":true}},"description":"Identity to apply the rule for.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Access rules configuration.","description_kind":"markdown"}},"satori_custom_taxonomy_category":{"version":0,"block":{"attributes":{"color":{"type":"string","description":"Category color.","description_kind":"markdown","required":true},"description":{"type":"string","description":"Category description.","description_kind":"markdown","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description":"Category name.","description_kind":"markdown","required":true},"parent_category":{"type":"string","description":"Parent category ID.","description_kind":"markdown","optional":true},"tag":{"type":"string","description":"Category tag.","description_kind":"markdown","computed":true}},"description":"Custom taxonomy category.","description_kind":"markdown"}},"satori_custom_taxonomy_classifier":{"version":0,"block":{"attributes":{"additional_satori_categories":{"type":["list","string"],"description":"List of additional Satori taxonomy category IDs.\nSee https://satoricyber.com/docs/taxonomy/standard-categories for a list of possible values.","description_kind":"markdown","optional":true},"description":{"type":"string","description":"Classifier description.","description_kind":"markdown","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description":"Classifier name.","description_kind":"markdown","required":true},"parent_category":{"type":"string","description":"Parent category ID.","description_kind":"markdown","optional":true},"tag":{"type":"string","description":"Classifier tag.","description_kind":"markdown","computed":true},"type":{"type":"string","description":"Classifier type, valid types are: NON_AUTOMATIC, CUSTOM, SATORI_BASED.","description_kind":"markdown","required":true}},"block_types":{"custom_config":{"nesting_mode":"list","block":{"attributes":{"field_name_pattern":{"type":"string","description":"Field name pattern.","description_kind":"markdown","optional":true},"field_type":{"type":"string","description":"Field type, valid types are: ANY, TEXT, NUMERIC, DATE.","description_kind":"markdown","required":true},"value_case_sensitive":{"type":"bool","description":"Should value match be case sensitive. Defaults to `true`.","description_kind":"markdown","optional":true},"value_pattern":{"type":"string","description":"Value pattern.","description_kind":"markdown","optional":true},"values":{"type":["list","string"],"description":"List of possible field values.","description_kind":"markdown","optional":true}},"description":"Configuration for CUSTOM classifier type.","description_kind":"markdown"},"max_items":1},"satori_based_config":{"nesting_mode":"list","block":{"attributes":{"satori_base_classifier":{"type":"string","description":"Base Satori classifier ID.\nSee https://satoricyber.com/docs/taxonomy/standard-classifiers for a list of possible values.","description_kind":"markdown","required":true}},"description":"Configuration for SATORI_BASED classifier type.","description_kind":"markdown"},"max_items":1},"scope":{"nesting_mode":"list","block":{"attributes":{"datasets":{"type":["list","string"],"description":"IDs of datasets to include in the scope.","description_kind":"markdown","optional":true}},"block_types":{"include_location":{"nesting_mode":"list","block":{"attributes":{"datastore":{"type":"string","description":"Data store ID.","description_kind":"markdown","required":true}},"block_types":{"relational_location":{"nesting_mode":"list","block":{"attributes":{"db":{"type":"string","description":"Database name.","description_kind":"markdown","required":true},"schema":{"type":"string","description":"Schema name.","description_kind":"markdown","optional":true},"table":{"type":"string","description":"Table name.","description_kind":"markdown","optional":true}},"description":"Location for a relational data store.","description_kind":"markdown"},"max_items":1}},"description":"Location to include in the scope.","description_kind":"markdown"}}},"description":"Scope of relevant locations.","description_kind":"markdown"},"max_items":1}},"description":"Custom taxonomy classifier.","description_kind":"markdown"}},"satori_dataset":{"version":0,"block":{"attributes":{"data_policy_id":{"type":"string","description":"Parent ID for dataset permissions.","description_kind":"markdown","computed":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"security_policies":{"type":["list","string"],"description":"IDs of security policies to apply to this dataset.","description_kind":"markdown","optional":true}},"block_types":{"access_control_settings":{"nesting_mode":"list","block":{"attributes":{"enable_access_control":{"type":"bool","description":"Enforce access control to this dataset. Defaults to `false`.","description_kind":"markdown","optional":true},"enable_self_service":{"type":"bool","description":"Allow users to grant themselves access to this dataset. Defaults to `false`.","description_kind":"markdown","optional":true},"enable_user_requests":{"type":"bool","description":"Allow users to request access to this dataset. Defaults to `false`.","description_kind":"markdown","optional":true}},"description":"Dataset access controls.","description_kind":"markdown"},"min_items":1,"max_items":1},"custom_policy":{"nesting_mode":"list","block":{"attributes":{"priority":{"type":"number","description":"Dataset custom policy priority. Defaults to `100`.","description_kind":"markdown","optional":true},"rules_yaml":{"type":"string","description":"Custom policy rules YAML.","description_kind":"markdown","optional":true},"tags_yaml":{"type":"string","description":"Custom policy tags YAML.","description_kind":"markdown","optional":true}},"description":"Dataset custom policy.","description_kind":"markdown"},"min_items":1,"max_items":1},"definition":{"nesting_mode":"list","block":{"attributes":{"description":{"type":"string","description":"Dataset description.","description_kind":"markdown","optional":true},"name":{"type":"string","description":"Dataset name.","description_kind":"markdown","required":true},"owners":{"type":["list","string"],"description":"IDs of Satori users that will be set as dataset owners.","description_kind":"markdown","optional":true}},"block_types":{"exclude_location":{"nesting_mode":"list","block":{"attributes":{"datastore":{"type":"string","description":"Data store ID.","description_kind":"markdown","required":true}},"block_types":{"relational_location":{"nesting_mode":"list","block":{"attributes":{"db":{"type":"string","description":"Database name.","description_kind":"markdown","required":true},"schema":{"type":"string","description":"Schema name.","description_kind":"markdown","optional":true},"table":{"type":"string","description":"Table name.","description_kind":"markdown","optional":true}},"description":"Location for a relational data store.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Location to exclude from dataset.","description_kind":"markdown"}},"include_location":{"nesting_mode":"list","block":{"attributes":{"datastore":{"type":"string","description":"Data store ID.","description_kind":"markdown","required":true}},"block_types":{"relational_location":{"nesting_mode":"list","block":{"attributes":{"db":{"type":"string","description":"Database name.","description_kind":"markdown","required":true},"schema":{"type":"string","description":"Schema name.","description_kind":"markdown","optional":true},"table":{"type":"string","description":"Table name.","description_kind":"markdown","optional":true}},"description":"Location for a relational data store.","description_kind":"markdown"},"max_items":1}},"description":"Location to include in dataset.","description_kind":"markdown"}}},"description":"Parameters for dataset definition.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Full dataset configuration.","description_kind":"markdown"}},"satori_dataset_definition":{"version":0,"block":{"attributes":{"data_policy_id":{"type":"string","description":"Parent ID for dataset permissions.","description_kind":"markdown","computed":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true}},"block_types":{"definition":{"nesting_mode":"list","block":{"attributes":{"description":{"type":"string","description":"Dataset description.","description_kind":"markdown","optional":true},"name":{"type":"string","description":"Dataset name.","description_kind":"markdown","required":true},"owners":{"type":["list","string"],"description":"IDs of Satori users that will be set as dataset owners.","description_kind":"markdown","optional":true}},"block_types":{"exclude_location":{"nesting_mode":"list","block":{"attributes":{"datastore":{"type":"string","description":"Data store ID.","description_kind":"markdown","required":true}},"block_types":{"relational_location":{"nesting_mode":"list","block":{"attributes":{"db":{"type":"string","description":"Database name.","description_kind":"markdown","required":true},"schema":{"type":"string","description":"Schema name.","description_kind":"markdown","optional":true},"table":{"type":"string","description":"Table name.","description_kind":"markdown","optional":true}},"description":"Location for a relational data store.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Location to exclude from dataset.","description_kind":"markdown"}},"include_location":{"nesting_mode":"list","block":{"attributes":{"datastore":{"type":"string","description":"Data store ID.","description_kind":"markdown","required":true}},"block_types":{"relational_location":{"nesting_mode":"list","block":{"attributes":{"db":{"type":"string","description":"Database name.","description_kind":"markdown","required":true},"schema":{"type":"string","description":"Schema name.","description_kind":"markdown","optional":true},"table":{"type":"string","description":"Table name.","description_kind":"markdown","optional":true}},"description":"Location for a relational data store.","description_kind":"markdown"},"max_items":1}},"description":"Location to include in dataset.","description_kind":"markdown"}}},"description":"Parameters for dataset definition.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Dataset definition configuration only.","description_kind":"markdown"}},"satori_directory_group":{"version":0,"block":{"attributes":{"description":{"type":"string","description":"Group description.","description_kind":"markdown","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description":"Group name.","description_kind":"markdown","required":true}},"block_types":{"member":{"nesting_mode":"list","block":{"attributes":{"data_store_type":{"type":"string","description":"Data store type for member of type DB_ROLE, valid types are: SNOWFLAKE, REDSHIFT, BIGQUERY, POSTGRESQL, ATHENA, MSSQL, SYNAPSE","description_kind":"markdown","optional":true},"group_id":{"type":"string","description":"Directory group ID for member of type DIRECTORY_GROUP.","description_kind":"markdown","optional":true},"identity_provider":{"type":"string","description":"Identity provider type for member of type IDP_GROUP, valid identity providers are: OKTA, AZURE, ONELOGIN","description_kind":"markdown","optional":true},"name":{"type":"string","description":"Member name for types: USERNAME, IDP_GROUP and DB_ROLE.","description_kind":"markdown","optional":true},"type":{"type":"string","description":"Member type, valid types are: USERNAME, IDP_GROUP, DB_ROLE, DIRECTORY_GROUP.","description_kind":"markdown","required":true}},"description":"Group members.","description_kind":"markdown"},"min_items":1}},"description":"Directory group configuration.","description_kind":"markdown"}},"satori_masking_profile":{"version":0,"block":{"attributes":{"description":{"type":"string","description":"Masking profile description.","description_kind":"markdown","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description":"Masking profile name.","description_kind":"markdown","required":true}},"block_types":{"condition":{"nesting_mode":"list","block":{"attributes":{"replacement":{"type":"string","description":"Replacement, relevant for: REPLACE_CHAR, REPLACE_STRING.","description_kind":"markdown","optional":true},"tag":{"type":"string","description":"Tag.","description_kind":"markdown","required":true},"truncate":{"type":"number","description":"Truncate, relevant for: TRUNCATE.","description_kind":"markdown","optional":true},"type":{"type":"string","description":"Type. Can be one of [NULLIFY, TRUNCATE, REPLACE_CHAR, REPLACE_STRING, HASH, EMAIL_PREFIX, EMAIL_SUFFIX, EMAIL_FULL, EMAIL_HASH, CREDIT_CARD_PREFIX, CREDIT_CARD_FULL, CREDIT_CARD_HASH, IP_SUFFIX, IP_FULL, IP_HASH, DATE_YEAR_ONLY, DATE_1970_AGAIN, NO_ACTION, REDACT, NUMBER_ZERO, NUMBER_ROUND, ...]","description_kind":"markdown","required":true}},"description":"Masking profile condition.","description_kind":"markdown"},"min_items":1}},"description":"Masking Profile.","description_kind":"markdown"}},"satori_security_policy":{"version":0,"block":{"attributes":{"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description":"Security policy name.","description_kind":"markdown","required":true}},"block_types":{"profile":{"nesting_mode":"list","block":{"block_types":{"masking":{"nesting_mode":"list","block":{"attributes":{"active":{"type":"bool","description":"Is active.","description_kind":"markdown","required":true}},"block_types":{"rule":{"nesting_mode":"list","block":{"attributes":{"active":{"type":"bool","description":"Is active rule.","description_kind":"markdown","required":true},"description":{"type":"string","description":"Rule description.","description_kind":"markdown","required":true},"id":{"type":"string","description":"Rule id, has to be unique.","description_kind":"markdown","required":true}},"block_types":{"action":{"nesting_mode":"list","block":{"attributes":{"masking_profile_id":{"type":"string","description":"The reference id to be applied as masking profile.","description_kind":"markdown","required":true},"type":{"type":"string","description":"Rule type. Defaults to `APPLY_MASKING_PROFILE`.","description_kind":"markdown","optional":true}},"description":"Rule action.","description_kind":"markdown"},"min_items":1,"max_items":1},"criteria":{"nesting_mode":"list","block":{"attributes":{"condition":{"type":"string","description":"Identity condition, for example IS_NOT, IS, etc.","description_kind":"markdown","required":true}},"block_types":{"identity":{"nesting_mode":"list","block":{"attributes":{"group_id":{"type":"string","description":"Directory group ID for identity of type GROUP.\nCan not be changed after creation.","description_kind":"markdown","optional":true},"name":{"type":"string","description":"User/group name for identity types of USER and IDP_GROUP.\nCan not be changed after creation.","description_kind":"markdown","optional":true},"type":{"type":"string","description":"Identity type, valid types are: USER, IDP_GROUP, GROUP, EVERYONE.\nCan not be changed after creation.","description_kind":"markdown","required":true}},"description":"Identity to apply the rule for.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Masking criteria.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Masking Rule.","description_kind":"markdown"},"min_items":1}},"description":"Masking profile.","description_kind":"markdown"},"max_items":1}},"description":"Security policy profile.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Security Policy.","description_kind":"markdown"}},"satori_self_service_access_rule":{"version":0,"block":{"attributes":{"access_level":{"type":"string","description":"Access level to grant, valid values are: READ_ONLY, READ_WRITE, OWNER.","description_kind":"markdown","required":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"parent_data_policy":{"type":"string","description":"Parent data policy ID, the data_policy_id field of a dataset.","description_kind":"markdown","required":true},"revoke_if_not_used_in_days":{"type":"number","description":"Revoke access if rule not used in the last given days. Zero = do not revoke. Max value is 180. Defaults to `0`.","description_kind":"markdown","optional":true},"security_policies":{"type":["list","string"],"description":"IDs of security policies to apply to this rule. Empty list for default dataset security policies. [ \"none\" ] list for no policies.","description_kind":"markdown","optional":true}},"block_types":{"expire_in":{"nesting_mode":"list","block":{"attributes":{"unit_type":{"type":"string","description":"Unit type for units field, possible values are: MINUTES, HOURS, DAYS, WEEKS, MONTHS, YEARS.","description_kind":"markdown","required":true},"units":{"type":"number","description":"Number of units of unit_type.","description_kind":"markdown","required":true}},"description":"Rule expiration settings.","description_kind":"markdown"},"max_items":1},"identity":{"nesting_mode":"list","block":{"attributes":{"group_id":{"type":"string","description":"Directory group ID for identity of type GROUP.\nCan not be changed after creation.","description_kind":"markdown","optional":true},"name":{"type":"string","description":"User/group name for identity types of USER and IDP_GROUP.\nCan not be changed after creation.","description_kind":"markdown","optional":true},"type":{"type":"string","description":"Identity type, valid types are: USER, IDP_GROUP, GROUP, EVERYONE.\nCan not be changed after creation.","description_kind":"markdown","required":true}},"description":"Identity to apply the rule for.","description_kind":"markdown"},"min_items":1,"max_items":1}},"description":"Self service access rules configuration.","description_kind":"markdown"}}},"data_source_schemas":{"satori_user":{"version":0,"block":{"attributes":{"email":{"type":"string","description":"User's email address.","description_kind":"markdown","required":true},"id":{"type":"string","description":"User's ID.","description_kind":"markdown","computed":true}},"description":"Find user ID by email","description_kind":"markdown"}}}}}}
