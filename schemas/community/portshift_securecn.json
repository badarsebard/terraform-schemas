{"format_version":"0.2","provider_schemas":{"registry.terraform.io/portshift/securecn":{"provider":{"version":0,"block":{"attributes":{"access_key":{"type":"string","description":"SecureCN service account access key to authenticate with","description_kind":"plain","optional":true,"sensitive":true},"secret_key":{"type":"string","description":"SecureCN service account secret key to authenticate with","description_kind":"plain","optional":true,"sensitive":true},"server_url":{"type":"string","description":"SecureCN server URL","description_kind":"plain","optional":true}},"description_kind":"plain"}},"resource_schemas":{"securecn_cd_policy":{"version":1,"block":{"attributes":{"deployers":{"type":["list","string"],"description_kind":"plain","required":true},"description":{"type":"string","description_kind":"plain","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description_kind":"plain","required":true}},"block_types":{"api_security_policy":{"nesting_mode":"list","block":{"attributes":{"api_security_profile":{"type":"string","description":"The id of the api security profile to use for this api policy","description_kind":"plain","required":true},"enforcement_option":{"type":"string","description":"The enforcement type for this policy","description_kind":"plain","required":true}},"description":"Specify the cd policy's api security profile","description_kind":"plain"},"max_items":1},"permission_policy":{"nesting_mode":"list","block":{"attributes":{"enforcement_option":{"type":"string","description":"The enforcement type for this policy","description_kind":"plain","required":true},"permissible_vulnerability_level":{"type":"string","description":"The level of risk accepted in this policy","description_kind":"plain","required":true}},"description":"Specify the cd policy's permission check profile","description_kind":"plain"},"max_items":1},"secret_policy":{"nesting_mode":"list","block":{"attributes":{"enforcement_option":{"type":"string","description":"The enforcement type for this policy","description_kind":"plain","required":true},"permissible_vulnerability_level":{"type":"string","description":"The level of risk accepted in this policy","description_kind":"plain","required":true}},"description":"Specify the cd policy's secret check profile","description_kind":"plain"},"max_items":1},"security_context_policy":{"nesting_mode":"list","block":{"attributes":{"enforcement_option":{"type":"string","description":"The enforcement type for this policy","description_kind":"plain","required":true},"permissible_vulnerability_level":{"type":"string","description":"The level of risk accepted in this policy","description_kind":"plain","required":true}},"description":"Specify the cd policy's security context check profile","description_kind":"plain"},"max_items":1}},"description":"A SecureCN CD policy","description_kind":"plain"}},"securecn_ci_policy":{"version":1,"block":{"attributes":{"description":{"type":"string","description_kind":"plain","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description_kind":"plain","required":true}},"block_types":{"dockerfile_scan_policy":{"nesting_mode":"list","block":{"attributes":{"enforcement_option":{"type":"string","description":"The enforcement type for this policy","description_kind":"plain","required":true},"permissible_dockerfile_scan_severity":{"type":"string","description":"The scan result severity accepted in this policy","description_kind":"plain","required":true}},"description":"Specify the ci policy's dockerfile scan policy part","description_kind":"plain"},"max_items":1},"vulnerability_policy":{"nesting_mode":"list","block":{"attributes":{"enforcement_option":{"type":"string","description":"The enforcement type for this policy","description_kind":"plain","required":true},"permissible_vulnerability_level":{"type":"string","description":"The level of risk accepted in this policy","description_kind":"plain","required":true}},"description":"Specify the ci policy's vulnerability policy part","description_kind":"plain"},"max_items":1}},"description":"A SecureCN CI policy","description_kind":"plain"}},"securecn_connection_rule":{"version":1,"block":{"attributes":{"action":{"type":"string","description_kind":"plain","optional":true},"destination_by_external":{"type":"bool","description":"The destination will match on external connections","description_kind":"plain","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"rule_name":{"type":"string","description_kind":"plain","required":true},"source_by_external":{"type":"bool","description":"The source will match on external connections","description_kind":"plain","optional":true},"status":{"type":"string","description_kind":"plain","optional":true}},"block_types":{"destination_by_address_domain":{"nesting_mode":"list","block":{"attributes":{"domains":{"type":["list","string"],"description_kind":"plain","required":true}},"description":"The destination match will match using domain names","description_kind":"plain"},"max_items":1},"destination_by_address_ip_range":{"nesting_mode":"list","block":{"attributes":{"ips":{"type":["list","string"],"description_kind":"plain","required":true}},"description":"The destination match will match using ip ranges","description_kind":"plain"},"max_items":1},"destination_by_pod_any":{"nesting_mode":"list","block":{"attributes":{"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The destination will match on any pod (with given vulnerability severity (or higher) if configured)","description_kind":"plain"},"max_items":1},"destination_by_pod_label":{"nesting_mode":"list","block":{"attributes":{"labels":{"type":["map","string"],"description_kind":"plain","required":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The destination will match using pod labels","description_kind":"plain"},"max_items":1},"destination_by_pod_name":{"nesting_mode":"list","block":{"attributes":{"names":{"type":["list","string"],"description_kind":"plain","required":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The destination will match using pod names","description_kind":"plain"},"max_items":1},"source_by_ip_range":{"nesting_mode":"list","block":{"attributes":{"ips":{"type":["list","string"],"description_kind":"plain","required":true}},"description":"The source will match using ip ranges","description_kind":"plain"},"max_items":1},"source_by_pod_any":{"nesting_mode":"list","block":{"attributes":{"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The source will match on any pod (with given vulnerability severity (or higher) if configured)","description_kind":"plain"},"max_items":1},"source_by_pod_label":{"nesting_mode":"list","block":{"attributes":{"labels":{"type":["map","string"],"description_kind":"plain","required":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The source will match using pod labels","description_kind":"plain"},"max_items":1},"source_by_pod_name":{"nesting_mode":"list","block":{"attributes":{"names":{"type":["list","string"],"description_kind":"plain","required":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The source will match using pod names","description_kind":"plain"},"max_items":1}},"description":"A SecureCN k8s connection rule","description_kind":"plain"}},"securecn_deployer":{"version":1,"block":{"attributes":{"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description_kind":"plain","required":true}},"block_types":{"operator_deployer":{"nesting_mode":"list","block":{"attributes":{"cluster_id":{"type":"string","description":"The id of the kubernetes cluster in SecureCN of this deployer","description_kind":"plain","required":true},"namespace":{"type":"string","description":"The namespace of the ServiceAccount of this deployer","description_kind":"plain","required":true},"rule_creation":{"type":"bool","description":"Enable connection rule creation for this deployer","description_kind":"plain","optional":true},"security_check":{"type":"bool","description":"Enable security checks for this deployer","description_kind":"plain","optional":true},"service_account":{"type":"string","description":"The Kubernetes ServiceAccount name of the deployer","description_kind":"plain","required":true}},"description":"Create and modify an operator deployer's properties","description_kind":"plain"},"max_items":1}},"description":"A SecureCN deployer","description_kind":"plain"}},"securecn_deployment_rule":{"version":1,"block":{"attributes":{"action":{"type":"string","description_kind":"plain","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"rule_name":{"type":"string","description_kind":"plain","required":true},"scope":{"type":"string","description":"Scope defines the scope of this rule","description_kind":"plain","optional":true},"status":{"type":"string","description_kind":"plain","optional":true}},"block_types":{"match_by_pod_any":{"nesting_mode":"list","block":{"attributes":{"psp_on_violation_action":{"type":"string","description_kind":"plain","optional":true},"psp_profile":{"type":"string","description_kind":"plain","optional":true},"vulnerability_on_violation_action":{"type":"string","description_kind":"plain","optional":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The rule will match on any pod","description_kind":"plain"},"max_items":1},"match_by_pod_label":{"nesting_mode":"list","block":{"attributes":{"labels":{"type":["map","string"],"description_kind":"plain","required":true},"psp_on_violation_action":{"type":"string","description_kind":"plain","optional":true},"psp_profile":{"type":"string","description_kind":"plain","optional":true},"vulnerability_on_violation_action":{"type":"string","description_kind":"plain","optional":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The rule will match using pod labels","description_kind":"plain"},"max_items":1},"match_by_pod_name":{"nesting_mode":"list","block":{"attributes":{"names":{"type":["list","string"],"description_kind":"plain","required":true},"psp_on_violation_action":{"type":"string","description_kind":"plain","optional":true},"psp_profile":{"type":"string","description_kind":"plain","optional":true},"vulnerability_on_violation_action":{"type":"string","description_kind":"plain","optional":true},"vulnerability_severity_level":{"type":"string","description_kind":"plain","optional":true}},"description":"The rule will match using pod names","description_kind":"plain"},"max_items":1}},"description":"A SecureCN deployment rule","description_kind":"plain"}},"securecn_environment":{"version":1,"block":{"attributes":{"description":{"type":"string","description_kind":"plain","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"name":{"type":"string","description_kind":"plain","required":true}},"block_types":{"kubernetes_environment":{"nesting_mode":"list","block":{"attributes":{"cluster_name":{"type":"string","description":"The name of the kubernetes cluster in SecureCN","description_kind":"plain","required":true},"namespaces_by_labels":{"type":["map","string"],"description":"The source will match using namespace labels","description_kind":"plain","optional":true},"namespaces_by_names":{"type":["list","string"],"description":"The env will match using namespace name","description_kind":"plain","optional":true}},"description":"The kubernetes environments to include in the SecureCN env","description_kind":"plain"},"min_items":1}},"description":"A SecureCN environment","description_kind":"plain"}},"securecn_k8s_cluster":{"version":0,"block":{"attributes":{"api_intelligence_dast":{"type":"bool","description":"Enable API Intelligence DAST integration","description_kind":"plain","optional":true},"auto_labeling":{"type":"bool","description":"Enable auto labeling of Kubernetes namespaces","description_kind":"plain","optional":true},"cd_pod_template":{"type":"bool","description":"Identify pod templates only originating from SecureCN CD plugin","description_kind":"plain","optional":true},"ci_image_validation":{"type":"bool","description":"Identify pods only if the image hash matches the value generated by the CI plugin or entered manually in the UI","description_kind":"plain","optional":true},"connections_control":{"type":"bool","description":"Enable connections control","description_kind":"plain","optional":true},"external_https_proxy":{"type":"string","description":"Proxy definitions for outgoing HTTPS traffic from the cluster, if needed","description_kind":"plain","optional":true},"fail_close":{"type":"bool","description":"When enabled, workloads and connections will be blocked in case SecureCN agent is not responding","description_kind":"plain","optional":true},"hold_application_until_proxy_starts":{"type":"bool","description":"Indicates whether the controller should hold the application until the proxy starts","description_kind":"plain","optional":true},"id":{"type":"string","description_kind":"plain","optional":true,"computed":true},"inspect_incoming_cluster_connections":{"type":"bool","description":"Enable enforcement and visibility of connections from external IP sources","description_kind":"plain","optional":true},"istio_ingress_annotations":{"type":["map","string"],"description":"If enabling Istio ingress, use Istio these ingress annotation","description_kind":"plain","optional":true},"istio_ingress_enabled":{"type":"bool","description":"If installing Istio, use Istio ingress","description_kind":"plain","optional":true,"computed":true},"istio_version":{"type":"string","description":"When installing SecureCN agent deployment, use the already existing Istio deployment","description_kind":"plain","optional":true,"computed":true},"kubernetes_cluster_context":{"type":"string","description":"The k8s context name of the cluster","description_kind":"plain","required":true},"multi_cluster_communication_support":{"type":"bool","description":"Enable multi cluster communication","description_kind":"plain","optional":true},"multi_cluster_communication_support_certs_path":{"type":"string","description":"Multi cluster certs path. Only valid if multi_cluster_communication_support is true","description_kind":"plain","optional":true},"name":{"type":"string","description":"The name of cluster in SecureCN","description_kind":"plain","required":true},"orchestration_type":{"type":"string","description":"Orchestration type of the kubernetes cluster","description_kind":"plain","optional":true},"persistent_storage":{"type":"bool","description":"Allow SecureCN agent to save the policy persistently, so it will be available after a restart of the pod. This will Require 128MB of storage for the agent pod.","description_kind":"plain","optional":true},"restrict_registries":{"type":"bool","description":"Workload from untrusted registries will be marked as 'unknown'","description_kind":"plain","optional":true},"service_discovery_isolation":{"type":"bool","description":"Indicates whether the service discovery isolation is enabled","description_kind":"plain","optional":true},"skip_ready_check":{"type":"bool","description":"Indicates whether the cluster installation should be async","description_kind":"plain","optional":true},"spec_reconstruction":{"type":"bool","description":"Indicates whether the OpenAPI specification reconstruction is enabled","description_kind":"plain","optional":true},"tls_inspection":{"type":"bool","description":"Indicates whether the TLS inspection is enabled","description_kind":"plain","optional":true,"computed":true},"token_injection":{"type":"bool","description":"Indicates whether the token injection is enabled","description_kind":"plain","optional":true},"trace_analyzer":{"type":"bool","description":"Indicates whether the trace analyzer is enabled","description_kind":"plain","optional":true},"tracing_support":{"type":"bool","description":"Indicates whether to install tracing support, enable for apiSecurity accounts.","description_kind":"plain","optional":true},"venafi_integration":{"type":"bool","description":"Enable Venafi integration","description_kind":"plain","optional":true}},"block_types":{"external_ca":{"nesting_mode":"list","block":{"attributes":{"id":{"type":"string","description":"The id of the external CA","description_kind":"plain","required":true},"name":{"type":"string","description":"The name of the external CA","description_kind":"plain","optional":true}},"description":"Use an external CA for this cluster","description_kind":"plain"},"max_items":1},"internal_registry":{"nesting_mode":"list","block":{"attributes":{"url":{"type":"string","description":"The url of the internal registry","description_kind":"plain","required":true}},"description":"Use an internal container registry for this cluster","description_kind":"plain"},"max_items":1},"sidecar_resources":{"nesting_mode":"list","block":{"attributes":{"proxy_init_limits_cpu":{"type":"number","description_kind":"plain","optional":true},"proxy_init_limits_memory":{"type":"number","description_kind":"plain","optional":true},"proxy_init_requests_cpu":{"type":"number","description_kind":"plain","optional":true},"proxy_init_requests_memory":{"type":"number","description_kind":"plain","optional":true},"proxy_limits_cpu":{"type":"number","description_kind":"plain","optional":true},"proxy_limits_memory":{"type":"number","description_kind":"plain","optional":true},"proxy_requests_cpu":{"type":"number","description_kind":"plain","optional":true},"proxy_requests_memory":{"type":"number","description_kind":"plain","optional":true}},"description":"Define resource limits for Istio sidecars","description_kind":"plain"},"max_items":1}},"description":"A SecureCN k8s cluster","description_kind":"plain"}}}}}}
